---
title: pandas使用方法与常用实例
tags:
  - pandas
  - 笔记
date: 2020-05-07 14:20:04
---
## pandas使用方法与常用实例
### 代码创建表格并输出成文件

**方法一**：

有的功能基于openpyxl模块，如果没有需要用pip安装

	import pandas as pd
	df1=pd.DataFrame({'工资':[9000,7000,4000,8000,100000],'绩效分':[86,91,74,83,97],'性别':['男','女','女','女','女']},index=['~王闵京','~陈红英','~张秀影','~王春芳','~陈春月'])
	print(df1)
	#将数据保存成表格文件
	writer=pd.ExcelWriter('my2.xlsx') 
	df1.to_excel(writer,float_format='%.5f')
	writer.save()

|    |工资        | 绩效分|   性别|
|:-----|:--------|:-----:|-----:|
|王闵京|    9000|   86|  ~男|
|陈红英|    7000|   91|  ~女|
|张秀影|    4000|   74|  ~女|
|王春芳|    8000|   83|  ~女|
|陈春月|  100000|   97|  ~女|

**方法二**：

此方法需要导入numpy、openpyxl模块

	import pandas as pd
	import numpy as np
	data = np.arange(1,101).reshape((10,10))
	data_df = pd.DataFrame(data)
	data_df.columns = ['A','B','C','D','E','F','G','H','I','J']
	data_df.index = ['a','b','c','d','e','f','g','h','i','j']
	priint(data_df)
	writer = pd.ExcelWriter('my.xlsx')
	data_df.to_excel(writer,float_format='%.5f')
	writer.save()
	————————————————
	原文链接：https://blog.csdn.net/weixin_44285988/article/details/89156876


|   | A | B  | C  | D  | E  | F  | G  | H  | I  | J  |
|----|----|----|----|----|----|----|----|----|----|-----|
| a | 1  | 2  | 3  | 4  | 5  | 6  | 7  | 8  | 9  | 10  |
| b | 11 | 12 | 13 | 14 | 15 | 16 | 17 | 18 | 19 | 20  |
| c | 21 | 22 | 23 | 24 | 25 | 26 | 27 | 28 | 29 | 30  |
| d | 31 | 32 | 33 | 34 | 35 | 36 | 37 | 38 | 39 | 40  |
| e | 41 | 42 | 43 | 44 | 45 | 46 | 47 | 48 | 49 | 50  |
| f | 51 | 52 | 53 | 54 | 55 | 56 | 57 | 58 | 59 | 60  |
| g | 61 | 62 | 63 | 64 | 65 | 66 | 67 | 68 | 69 | 70  |
| h | 71 | 72 | 73 | 74 | 75 | 76 | 77 | 78 | 79 | 80  |
| i | 81 | 82 | 83 | 84 | 85 | 86 | 87 | 88 | 89 | 90  |
| j | 91 | 92 | 93 | 94 | 95 | 96 | 97 | 98 | 99 | 100 |

-

### 表格数据的字符串操作

例如表格中的某列数据中都有各种前缀想进行统一更改的时候，这时字符串的替换操作就可以大显身手了，pandas对字符串的操作和python几乎一样，只要调用数据的`.str`方法就可以了


	df1['性别']=df1['性别'].str.replace('~','')#编辑性别的列
	print('我是替换后的数据\n{0}'.format(df1))


|    |工资        | 绩效分|   性别|
|:-----|:--------|:-----:|-----:|
|王闵京|    9000|   86|  男|
|陈红英|    7000|   91|  女|
|张秀影|    4000|   74|  女|
|王春芳|    8000|   83|  女|
|陈春月|  100000|   97|  女|



### 表格中列与列之间的计算
接上表格，把所有人的工资增加9000

	df1['工资']=df1['工资']+9000#每个人的工资增加9000
	print('每个人的工资增加9000元\n{0}'.format(df1))

|    |工资        | 绩效分|   性别|
|:-----|:--------|:-----:|-----:|
|王闵京|    18000|   86|  男|
|陈红英|    16000|   91|  女|
|张秀影|    13000|   74|  女|
|王春芳|    17000|   83|  女|
|陈春月|  109000 |   97|  女|

列之间的计算都是数值类型进行的。如果数据中包含非数值类型的字符和符号，要先把其转换为数值类型在进行计算；例如：数据中有%
